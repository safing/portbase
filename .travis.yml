language: go

os:
  - linux
  - windows

branches:
  only:
    - master
    - develop
    - /^feature\/travis\/.+$/ # feature/travis/*
    - /^fix\/travis\/.+$/ # fix/travis/*

git:
  clone: false

before_install:
  - git config --global core.autocrlf false # disable to get LF line endings on windows
  - git clone https://github.com/$TRAVIS_REPO_SLUG.git $TRAVIS_REPO_SLUG # custom clone to disable core.autocrlf config
  - cd $TRAVIS_REPO_SLUG
  - git checkout -qf $TRAVIS_COMMIT

install:
  - go get -d -u github.com/golang/dep
  - go install github.com/golang/dep/cmd/dep
  - dep ensure
  - ./test install

script: ./test --scripted
